---
title: "Survey Results Task 3.3 731951"
author: "Anja Rainer"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, dpi = 300)

df <- tar_read(with_countries)

question_codes <- read_csv("data/processed/question_codes.csv")

theme_set(theme_bw())
```



```{r remove non consenters}

# number of cases:
nrow(df)
```
Our sample is based on `r nrow(df)` cases.

# Missing data

```{r}

vis_dat(df)
visdat::vis_miss(df)

```

```{r, fig.width=12}
df %>% 
  select_if(function(x) (sum(is.na(x)))/length(x) > .1) %>% 
  vis_miss()
```

# Demographics

# Age cohorts

```{r, fig.width=8, fig.height=5}

answer_levels_e3 <- c("<20", "20-29", "30-39", "40-49", "50-59", "60-69", "70+")

e3_df <- df %>% 
  select("E3")

e3_df_rec <- e3_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_e3))


e3_df_rec %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

e3_df_rec %>%
  mutate(across(.fns = as.numeric)) %>% 
  summarise(across(everything(), ~mean(.x, na.rm = TRUE)))

e3_df_rec %>%
  ggplot(aes(E3)) +
  geom_bar(width = .7) +
  coord_flip() +
  labs(x = NULL, title = "Age cohorts")



```


# Gender

```{r, fig.width=8, fig.height=5}

answer_levels_e2 <- c("Man", "Woman", "Prefer not to say", "Other")

e2_df <- df %>% 
  select("E2")

e2_df_rec <- e2_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_e2))


e2_df_rec %>% 
  count(E2) %>% 
  ggplot(aes(fct_reorder(E2, n, .fun = "max"), n)) +
  geom_col(width = .7) +
  coord_flip() +
  labs(x = NULL, title = "Gender")

```

# Publish first academic publication

```{r, fig.width=8, fig.height=5}

e3b_df <- df %>% 
  select("E3b") %>% 
  filter(E3b > 1960)

e3b_df %>% 
  ggplot(aes(E3b)) +
  geom_histogram() +
  labs(x = NULL, title = "Publish first academic publication")

```


# Highest education

```{r, fig.width=8, fig.height=5}
answer_levels_e4 <- c("Post-secondary non-tertiary education (e.g. VET Schools, schools of healthcare and nursing)", "Short-cycle tertiary education (e.g. master schools, colleges, vocational training schools)", "Bachelor or equivalent", "Master or equivalent", "Doctorate or equivalent", "Other")

answer_labels_e4 <- str_wrap(answer_levels_e4, 30)

e4_df <- df %>% 
  select("E4")

e4_df_rec <- e4_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_e4, 
                labels = answer_labels_e4))

e4_df_rec %>%
  # rename(Post-secondary non-tertiary education = Post-secondary non-tertiary education (e.g. VET Schools, schools of healthcare and nursing) %>%
  count(E4) %>%
  ggplot(aes(fct_reorder(E4, n, .fun = "max"), n)) +
  geom_col(width = .7) +
  coord_flip() +
  labs(x = NULL, title = "Highest education")
```

# Types of institution

```{r, fig.width=8, fig.height=5}

answer_levels_e5 <- c("University", "Public research institute", "Private research institute", "Company", "Nonprofit", "Other")

e5_df <- df %>% 
  select("E5")

e5_df_rec <- e5_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_e5))

e5_df_rec %>% 
  count(E5) %>% 
  ggplot(aes(fct_reorder(E5, n, .fun = "max"), n)) +
  geom_col(width = .7) +
  coord_flip() +
  labs(x = NULL, title = "In what type of institution do you work?")

```

# Position

```{r, fig.width=8, fig.height=5}

answer_levels_e6 <- c("Junior Researcher", "Senior Researcher", "Ph.D. student", "Postdoctoral fellow/ researcher", "Assistant professor", 
                      "Associate professor", "Full professor", "Associate research scientist", "Instructor", "Lecturer", "Adjunct professor", 
                      "Technician or lab manager", "Core facility manager", "Other")

e6_df <- df %>% 
  select("E6")

e6_df_rec <- e6_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_e6))

e6_df_rec %>% 
  count(E6) %>% 
  ggplot(aes(fct_reorder(E6, n, .fun = "max"), n)) +
  geom_col(width = .7) +
  coord_flip() +
  labs(x = NULL, title = "Position")

```

# Respondents by disciplines

```{r, fig.width=8, fig.height=5}

answer_levels_e7 <- c("Natural Sciences", "Engineering and technology", "Medical and health sciences", "Agricultural and Veterinary sciences", 
                      "Social Sciences", "Humanities and the Arts")

e7_df <- df %>% 
  select("E7")

e7_df_rec <- e7_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_e7))

e7_df_rec %>% 
  count(E7) %>% 
  ggplot(aes(fct_reorder(E7, n, .fun = "max"), n)) +
  geom_col(width = .7) +
  coord_flip() +
  labs(x = NULL, title = "Respondents by discipline")

```


# A1 Practices in OS

```{r, fig.width=8, fig.height=5}

answer_levels <- c("Strongly disagree", "Disagree", "Neither agree nor disagree",
                   "Agree", "Strongly agree", 
                   "This topic is not relevant to my research", 
                   "Don’t know/ Don’t have enough information")


a1_df <- df %>% 
  select(starts_with("A1[")) 

a1_df_rec <- a1_df %>% 
  mutate(across(.fns = factor, levels = answer_levels))


a1_df %>% 
  summarise(across(.fns = ~sum(is.na(.x))))
```


```{r}
a1_df_rec %>% 
  summarise(across(.fns = ~sum(is.na(.x))))
```


```{r, fig.width=8, fig.height=5}
visdat::vis_miss(a1_df_rec)

a1_df_rec %>% 
  plot_likert(question_codes, "Practices regarding OS")


```


# A2 Own pratices regarding Open Access publishing

```{r, fig.width=8, fig.height=5}

answer_levels_2 <- c("Never", "Rarely", "Sometimes",
                   "Often", "Always", "This topic is not relevant to my research", 
                   "Don’t know/ Don’t have enough information")


a2_df <- df %>% 
  select(starts_with("A2[")) 

a2_df_rec <- a2_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_2))


a2_df %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

a2_df_rec %>% 
  plot_likert(question_codes, "Own pratices regarding Open Access publishing")
```


# A3 Own practices regarding Research Data Management

```{r, fig.width=8, fig.height=5}

a3_df <- df %>% 
  select(starts_with("A3[")) 

a3_df_rec <- a3_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_2))


a3_df %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

a3_df_rec %>% 
  plot_likert(question_codes, "Own practices regarding Research Data Management")
```


# A4 Practices regarding Reproducible Research Scale

```{r, fig.width=8, fig.height=5}

a4_df <- df %>% 
  select(starts_with("A4[")) 

a4_df_rec <- a4_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_2))


a4_df %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

a4_df_rec %>% 
  plot_likert(question_codes, "Practices regarding Reproducible Research Scale")

```


# A5 Pratices regarding Open Peer Review Scale

```{r, fig.width=8, fig.height=5}

answer_levels <- c("Strongly disagree", "Disagree", "Neither agree nor disagree",
                   "Agree", "Strongly agree", 
                   "This topic is not relevant to my research", 
                   "Don’t know/ Don’t have enough information")


a5_df <- df %>% 
  select(starts_with("A5[")) 

a5_df_rec <- a5_df %>% 
  mutate(across(.fns = factor, levels = answer_levels))


a5_df %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

a5_df_rec %>% 
  plot_likert(question_codes, "Pratices regarding Open Peer Review Scale")

```


# A6 Practices regarding Open Source Software Scale

```{r, fig.width=8, fig.height=5}

a6_df <- df %>% 
  select(starts_with("A6[")) 

a6_df_rec <- a6_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_2))


a6_df %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

a6_df_rec %>% 
  plot_likert(question_codes, "Practices regarding Open Source Software Scale")

```


# A7 Practices regarding Licensing Scale

```{r, fig.width=8, fig.height=5}

a7_df <- df %>% 
  select(starts_with("A7[")) 

a7_df_rec <- a7_df %>% 
  mutate(across(.fns = factor, levels = answer_levels))


a7_df %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

a7_df_rec %>% 
  plot_likert(question_codes, "Practices regarding Licensing Scale")
```


# A8 Practices regarding Research Integrity Scale

```{r, fig.width=8, fig.height=5}

a8_df <- df %>% 
  select(starts_with("A8[")) 

a8_df_rec <- a8_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_2))


a8_df %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

a8_df_rec %>% 
  plot_likert(question_codes, "Practices regarding Research Integrity Scale")
```


# A9 Practices regarding Citizen Science (information, consultation, public participation )

```{r, fig.width=8, fig.height=5}

a9_df <- df %>% 
  select(starts_with("A9[")) 

a9_df_rec <- a9_df %>% 
  mutate(across(.fns = factor, levels = answer_levels))


a9_df %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

a9_df_rec %>% 
  plot_likert(question_codes, "Practices regarding Citizen Science")
```


# A10 Practices regarding Gender Issues Scale

```{r, fig.width=8, fig.height=5}

a10_df <- df %>% 
  select(starts_with("A10[")) 

a10_df_rec <- a10_df %>% 
  mutate(across(.fns = factor, levels = answer_levels))


a10_df %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

a10_df_rec %>% 
  plot_likert(question_codes, "Practices regarding Gender Issues Scale")

```

# Part B Training on OS topics

# B1 Attended Training Events

```{r, fig.width=8, fig.height=8}

answer_levels_b1 <- c("None", "1", "2", "3-5", "more than 5")


b1_df <- df %>% 
  select(starts_with("B1[")) 

b1_df_rec <- b1_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_b1))


b1_df %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

b1_df_rec %>% 
  plot_likert(question_codes, "Attended Training Events")

```


# B3 Attended Different Types of Training Sessions

```{r, fig.width=8, fig.height=8}

answer_levels_b3 <- c("Never", "Once", "More than once")


b3_df <- df %>% 
  select(starts_with("B3[")) 

b3_df_rec <- b3_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_b3))


b3_df_rec %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

b3_df_rec %>% 
  plot_likert(question_codes, "Attended Different Types of Training Sessions")

```


# B5 Hours of training

```{r}
answer_levels_b5 <- c("None", "1", "2", "3-5", "More than 5", "Other")

b5_df <- df %>% 
  select("B5")

b5_df_rec <- b5_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_b5))

recode_successful(b5_df, b5_df_rec)


b5_df_rec %>% 
  count(B5) %>% 
  ggplot(aes(fct_reorder(B5, n, .fun = "max"), n)) +
  geom_col(width = .7) +
  coord_flip() +
  labs(x = NULL, title = "Hours of training")
```


# B6 Attended Different Types of Training Sessions

```{r, fig.width=8, fig.height=8}

answer_levels_b6 <- c("I didn’t receive training", "I need more training", 
                        "I received adequate training", "This topic is not relevant for my research")


b6_df <- df %>% 
  select(starts_with("B6[")) 

b6_df_rec <- b6_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_b6))


b6_df_rec %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

b6_df_rec %>% 
  plot_likert(question_codes, "Attended Different Types of Training Sessions")

```


# B8 Attendance of first formal training in any Open Science topic

```{r}
answer_levels_b8 <- c("During doctoral studies", "As a researcher", "During a conference", "Other")

b8_df <- df %>% 
  select("B8")

b8_df_rec <- b8_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_b8))


b8_df_rec %>% 
  count(B8) %>% 
  ggplot(aes(fct_reorder(B8, n, .fun = "max"), n)) +
  geom_col(width = .7) +
  coord_flip() +
  labs(x = NULL, title = "Attendance of first formal training in any Open Science topic")

```


Most responses from the "Other" category mention that they never received any
training.

# B9 Who provided the training sessions you attended?

```{r}
answer_levels_3 <- c("Yes", "No")

b9_df <- df %>% 
  select(starts_with("B9[")) 

b9_df_rec <- b9_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_3))


b9_df_rec %>% 
  plot_likert(question_codes, "Who provided the training sessions you attended?")

```


# B10 Preferred way to learn OS topics

```{r}

b10_df <- df %>% 
  select(starts_with("B10["))

b10_df_rec <- b10_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_3))


b10_df_rec %>% 
  plot_likert(question_codes, "Preferred way to learn OS topics")

```


# B11 Has your awareness of open science practices increased after the training you attended?

```{r, fig.width=8, fig.height=6}

answer_levels_4 <- c("Don’t know", "Highly disagree", "Disagree",
                     "Neither agree nor disagree",
                     "Agree", "Highly agree")


b11_df <- df %>% 
  select(starts_with("B11[")) 

b11_df_rec <- b11_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_4))

recode_successful(b11_df, b11_df_rec)


b11_df_rec %>% 
  plot_likert(question_codes, "Has your awareness of open science practices\nincreased after the training you attended?")

```


# B11 Would you share your experience with open science practices and tools with colleagues?

```{r, fig.width=8, fig.height=6}

b12_df <- df %>% 
  select(starts_with("B12[")) 

b12_df_rec <- b12_df %>% 
  mutate(across(.fns = factor, levels = answer_levels_4))


b12_df_rec %>% 
  summarise(across(.fns = ~sum(is.na(.x))))

b12_df_rec %>% 
  plot_likert(question_codes, "Would you share your experience with open science practices\nand tools with colleagues?")

```



# Further todos

- check out cases with weird first year of publication `df %>% filter(id %in% c(356, 420, 129))` 



